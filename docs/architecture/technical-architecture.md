# ğŸ—ï¸ MingLog æŠ€æœ¯æ¶æ„è®¾è®¡

## ğŸ“‹ æ¶æ„æ¦‚è§ˆ

MingLog é‡‡ç”¨æ¨¡å—åŒ–æ¶æ„è®¾è®¡ï¼Œæ”¯æŒåŠŸèƒ½æ¨¡å—çš„åŠ¨æ€åŠ è½½å’Œç®¡ç†ï¼Œç¡®ä¿ç³»ç»Ÿçš„å¯æ‰©å±•æ€§å’Œç»´æŠ¤æ€§ã€‚

### ğŸ¯ è®¾è®¡åŸåˆ™

- **æ¨¡å—åŒ–è§£è€¦**ï¼šåŠŸèƒ½ç‹¬ç«‹ï¼Œæ¥å£æ ‡å‡†åŒ–
- **äº‹ä»¶é©±åŠ¨**ï¼šæ¨¡å—é—´é€šè¿‡äº‹ä»¶ç³»ç»Ÿé€šä¿¡
- **æœ¬åœ°ä¼˜å…ˆ**ï¼šæ•°æ®æœ¬åœ°å­˜å‚¨ï¼Œå¯é€‰äº‘åŒæ­¥
- **ç±»å‹å®‰å…¨**ï¼šTypeScript ä¸¥æ ¼æ¨¡å¼
- **æ€§èƒ½ä¼˜å…ˆ**ï¼šæ‡’åŠ è½½ã€è™šæ‹ŸåŒ–ã€ç¼“å­˜ä¼˜åŒ–

## ğŸ›ï¸ ç³»ç»Ÿæ¶æ„

### åˆ†å±‚æ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åº”ç”¨å±‚ (Application Layer)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Desktop App (Tauri)  â”‚  Web App (React)  â”‚  Mobile (Future) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    è¡¨ç°å±‚ (Presentation Layer)               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ UI Componentsâ”‚ â”‚ Route Systemâ”‚ â”‚ Theme Systemâ”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    ä¸šåŠ¡å±‚ (Business Layer)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Notes   â”‚ â”‚ MindMap â”‚ â”‚ Tasks   â”‚ â”‚ Search  â”‚ â”‚ Sync    â”‚ â”‚
â”‚  â”‚ Module  â”‚ â”‚ Module  â”‚ â”‚ Module  â”‚ â”‚ Module  â”‚ â”‚ Module  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚Calendar â”‚ â”‚ Files   â”‚ â”‚Analyticsâ”‚ â”‚   AI    â”‚ â”‚ Plugin  â”‚ â”‚
â”‚  â”‚ Module  â”‚ â”‚ Module  â”‚ â”‚ Module  â”‚ â”‚ Module  â”‚ â”‚ System  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    æ ¸å¿ƒå±‚ (Core Layer)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ Module      â”‚ â”‚ Event       â”‚ â”‚ Database    â”‚            â”‚
â”‚  â”‚ Manager     â”‚ â”‚ System      â”‚ â”‚ Manager     â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    æ•°æ®å±‚ (Data Layer)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ SQLite      â”‚ â”‚ File System â”‚ â”‚ Search Indexâ”‚            â”‚
â”‚  â”‚ Database    â”‚ â”‚ Storage     â”‚ â”‚ (MeiliSearch)â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§© æ ¸å¿ƒç»„ä»¶è®¾è®¡

### 1. æ¨¡å—ç®¡ç†å™¨ (ModuleManager)

```typescript
interface ModuleManager {
  // æ¨¡å—æ³¨å†Œå’Œç®¡ç†
  registerModule(id: string, factory: ModuleFactory, config: ModuleConfig): Promise<void>
  unregisterModule(moduleId: string): Promise<void>
  
  // æ¨¡å—ç”Ÿå‘½å‘¨æœŸ
  activateModule(moduleId: string): Promise<void>
  deactivateModule(moduleId: string): Promise<void>
  reloadModule(moduleId: string): Promise<void>
  
  // æ¨¡å—æŸ¥è¯¢
  getModule(moduleId: string): Module | null
  getActiveModules(): Module[]
  getModuleStatus(moduleId: string): ModuleStatus
  
  // ä¾èµ–ç®¡ç†
  resolveDependencies(moduleId: string): string[]
  validateDependencies(): DependencyValidationResult
}

interface ModuleFactory {
  create(config: ModuleConfig, coreAPI: CoreAPI): Promise<Module>
}

interface ModuleConfig {
  id: string
  name: string
  version: string
  description: string
  enabled: boolean
  dependencies: string[]
  settings: Record<string, any>
  permissions: Permission[]
}

enum ModuleStatus {
  UNREGISTERED = 'unregistered',
  REGISTERED = 'registered',
  INITIALIZING = 'initializing',
  ACTIVE = 'active',
  DEACTIVATING = 'deactivating',
  INACTIVE = 'inactive',
  ERROR = 'error'
}
```

### 2. äº‹ä»¶ç³»ç»Ÿ (EventBus)

```typescript
interface EventBus {
  // äº‹ä»¶å‘é€
  emit(type: string, data?: any, source?: string, target?: string): void
  emitAsync(type: string, data?: any, source?: string, target?: string): Promise<void>
  
  // äº‹ä»¶ç›‘å¬
  on(type: string, handler: EventHandler): void
  once(type: string, handler: EventHandler): void
  off(type: string, handler: EventHandler): void
  
  // äº‹ä»¶ç­‰å¾…
  waitFor(type: string, timeout?: number): Promise<ModuleEvent>
  
  // äº‹ä»¶è¿‡æ»¤å’Œè·¯ç”±
  filter(predicate: EventPredicate): EventBus
  route(pattern: string, handler: EventHandler): void
  
  // äº‹ä»¶å†å²å’Œè°ƒè¯•
  getEventHistory(limit?: number): ModuleEvent[]
  enableDebugMode(enabled: boolean): void
}

interface ModuleEvent {
  id: string
  type: string
  data?: any
  source?: string
  target?: string
  timestamp: number
  metadata?: Record<string, any>
}

type EventHandler = (event: ModuleEvent) => void | Promise<void>
type EventPredicate = (event: ModuleEvent) => boolean
```

### 3. æ•°æ®åº“ç®¡ç†å™¨ (DatabaseManager)

```typescript
interface DatabaseManager {
  // æ¨¡å¼ç®¡ç†
  registerSchema(moduleId: string, schema: DatabaseSchema): Promise<void>
  migrateSchema(moduleId: string, version: string): Promise<void>
  
  // æŸ¥è¯¢æ“ä½œ
  query<T>(sql: string, params?: any[]): Promise<T[]>
  queryOne<T>(sql: string, params?: any[]): Promise<T | null>
  execute(sql: string, params?: any[]): Promise<void>
  
  // äº‹åŠ¡æ”¯æŒ
  transaction<T>(callback: (tx: Transaction) => Promise<T>): Promise<T>
  
  // è¿æ¥ç®¡ç†
  getConnection(): Promise<Connection>
  closeConnection(): Promise<void>
  
  // å¤‡ä»½å’Œæ¢å¤
  backup(path: string): Promise<void>
  restore(path: string): Promise<void>
  
  // æ€§èƒ½ç›‘æ§
  getQueryStats(): QueryStats
  enableQueryLogging(enabled: boolean): void
}

interface DatabaseSchema {
  version: string
  tables: TableDefinition[]
  indexes: IndexDefinition[]
  migrations: Migration[]
}

interface TableDefinition {
  name: string
  columns: ColumnDefinition[]
  constraints?: ConstraintDefinition[]
}

interface Migration {
  version: string
  up: string[]
  down: string[]
  validate?: (db: DatabaseManager) => Promise<boolean>
}
```

## ğŸ”Œ æ¨¡å—æ¥å£æ ‡å‡†

### æ ‡å‡†æ¨¡å—æ¥å£

```typescript
interface Module {
  // åŸºæœ¬ä¿¡æ¯
  readonly id: string
  readonly name: string
  readonly version: string
  readonly description: string
  readonly dependencies: string[]
  readonly permissions: Permission[]
  
  // ç”Ÿå‘½å‘¨æœŸæ–¹æ³•
  initialize(core: CoreAPI): Promise<void>
  activate(): Promise<void>
  deactivate(): Promise<void>
  destroy(): Promise<void>
  
  // åŠŸèƒ½æä¾›
  getRoutes?(): ModuleRoute[]
  getMenuItems?(): ModuleMenuItem[]
  getToolbarItems?(): ToolbarItem[]
  getSettings?(): SettingItem[]
  getCommands?(): Command[]
  
  // äº‹ä»¶å¤„ç†
  onEvent?(event: ModuleEvent): void | Promise<void>
  
  // å¥åº·æ£€æŸ¥
  healthCheck?(): Promise<HealthStatus>
}

interface CoreAPI {
  // æ ¸å¿ƒæœåŠ¡
  readonly moduleManager: ModuleManager
  readonly eventBus: EventBus
  readonly database: DatabaseManager
  readonly fileSystem: FileSystemManager
  readonly search: SearchManager
  
  // å·¥å…·å‡½æ•°
  readonly utils: {
    uuid(): string
    debounce<T extends (...args: any[]) => any>(fn: T, delay: number): T
    throttle<T extends (...args: any[]) => any>(fn: T, delay: number): T
    deepClone<T>(obj: T): T
  }
  
  // é…ç½®ç®¡ç†
  getConfig(key: string): any
  setConfig(key: string, value: any): void
  
  // æ—¥å¿—ç³»ç»Ÿ
  logger: Logger
}
```

### æ¨¡å—è·¯ç”±ç³»ç»Ÿ

```typescript
interface ModuleRoute {
  path: string
  component: React.ComponentType
  title?: string
  icon?: string
  exact?: boolean
  guards?: RouteGuard[]
  meta?: Record<string, any>
}

interface RouteGuard {
  canActivate(route: ModuleRoute, context: RouteContext): boolean | Promise<boolean>
}

interface RouteContext {
  user?: User
  permissions: Permission[]
  moduleStates: Record<string, ModuleStatus>
}
```

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒè¡¨ç»“æ„

```sql
-- æ¨¡å—é…ç½®è¡¨
CREATE TABLE modules (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL,
  version TEXT NOT NULL,
  description TEXT,
  enabled BOOLEAN DEFAULT TRUE,
  config JSON DEFAULT '{}',
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- æ¨¡å—ä¾èµ–è¡¨
CREATE TABLE module_dependencies (
  module_id TEXT NOT NULL,
  dependency_id TEXT NOT NULL,
  version_constraint TEXT,
  PRIMARY KEY (module_id, dependency_id),
  FOREIGN KEY (module_id) REFERENCES modules(id),
  FOREIGN KEY (dependency_id) REFERENCES modules(id)
);

-- äº‹ä»¶å†å²è¡¨
CREATE TABLE event_history (
  id TEXT PRIMARY KEY,
  type TEXT NOT NULL,
  source TEXT,
  target TEXT,
  data JSON,
  timestamp DATETIME DEFAULT CURRENT_TIMESTAMP,
  INDEX idx_event_type (type),
  INDEX idx_event_timestamp (timestamp)
);

-- ç”¨æˆ·è®¾ç½®è¡¨
CREATE TABLE user_settings (
  key TEXT PRIMARY KEY,
  value JSON NOT NULL,
  module_id TEXT,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (module_id) REFERENCES modules(id)
);
```

### æ¨¡å—æ•°æ®è¡¨

```sql
-- ç¬”è®°è¡¨ (Notes Module)
CREATE TABLE notes (
  id TEXT PRIMARY KEY,
  title TEXT NOT NULL,
  content TEXT NOT NULL DEFAULT '',
  content_type TEXT DEFAULT 'markdown',
  tags JSON DEFAULT '[]',
  is_favorite BOOLEAN DEFAULT FALSE,
  is_archived BOOLEAN DEFAULT FALSE,
  parent_id TEXT,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (parent_id) REFERENCES notes(id)
);

-- ä»»åŠ¡è¡¨ (Tasks Module)
CREATE TABLE tasks (
  id TEXT PRIMARY KEY,
  title TEXT NOT NULL,
  description TEXT,
  status TEXT DEFAULT 'todo',
  priority TEXT DEFAULT 'medium',
  project_id TEXT,
  parent_id TEXT,
  assignee_id TEXT,
  due_date DATETIME,
  completed_at DATETIME,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (parent_id) REFERENCES tasks(id)
);

-- æ–‡ä»¶è¡¨ (Files Module)
CREATE TABLE files (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL,
  original_name TEXT NOT NULL,
  type TEXT NOT NULL,
  size INTEGER NOT NULL,
  path TEXT NOT NULL,
  checksum TEXT NOT NULL,
  thumbnail_path TEXT,
  metadata JSON DEFAULT '{}',
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- å…³è”è¡¨
CREATE TABLE note_files (
  note_id TEXT NOT NULL,
  file_id TEXT NOT NULL,
  position INTEGER DEFAULT 0,
  PRIMARY KEY (note_id, file_id),
  FOREIGN KEY (note_id) REFERENCES notes(id),
  FOREIGN KEY (file_id) REFERENCES files(id)
);

CREATE TABLE task_notes (
  task_id TEXT NOT NULL,
  note_id TEXT NOT NULL,
  PRIMARY KEY (task_id, note_id),
  FOREIGN KEY (task_id) REFERENCES tasks(id),
  FOREIGN KEY (note_id) REFERENCES notes(id)
);
```

## ğŸš€ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 1. æ¨¡å—æ‡’åŠ è½½

```typescript
// åŠ¨æ€æ¨¡å—åŠ è½½
const loadModule = async (moduleId: string): Promise<Module> => {
  const moduleFactory = await import(`./modules/${moduleId}/index.js`)
  return moduleFactory.createModule()
}

// è·¯ç”±çº§åˆ«çš„ä»£ç åˆ†å‰²
const NotesPage = React.lazy(() => import('./modules/notes/pages/NotesPage'))
const TasksPage = React.lazy(() => import('./modules/tasks/pages/TasksPage'))
```

### 2. è™šæ‹ŸåŒ–æ¸²æŸ“

```typescript
// å¤§åˆ—è¡¨è™šæ‹Ÿæ»šåŠ¨
import { FixedSizeList as List } from 'react-window'

const VirtualizedNoteList: React.FC<{ notes: Note[] }> = ({ notes }) => (
  <List
    height={600}
    itemCount={notes.length}
    itemSize={80}
    itemData={notes}
  >
    {NoteListItem}
  </List>
)
```

### 3. ç¼“å­˜ç­–ç•¥

```typescript
// æŸ¥è¯¢ç»“æœç¼“å­˜
class QueryCache {
  private cache = new Map<string, { data: any; timestamp: number }>()
  private ttl = 5 * 60 * 1000 // 5åˆ†é’Ÿ

  get<T>(key: string): T | null {
    const entry = this.cache.get(key)
    if (!entry || Date.now() - entry.timestamp > this.ttl) {
      this.cache.delete(key)
      return null
    }
    return entry.data
  }

  set<T>(key: string, data: T): void {
    this.cache.set(key, { data, timestamp: Date.now() })
  }
}
```

## ğŸ”’ å®‰å…¨æœºåˆ¶

### 1. æ¨¡å—æ²™ç®±

```typescript
// æ’ä»¶æ²™ç®±æ‰§è¡Œç¯å¢ƒ
class PluginSandbox {
  private iframe: HTMLIFrameElement
  private allowedAPIs: string[]

  constructor(allowedAPIs: string[]) {
    this.allowedAPIs = allowedAPIs
    this.iframe = this.createSandboxIframe()
  }

  execute(code: string, context: any): Promise<any> {
    return new Promise((resolve, reject) => {
      const message = { code, context, allowedAPIs: this.allowedAPIs }
      this.iframe.contentWindow?.postMessage(message, '*')
      
      const handler = (event: MessageEvent) => {
        if (event.data.type === 'result') {
          window.removeEventListener('message', handler)
          resolve(event.data.result)
        } else if (event.data.type === 'error') {
          window.removeEventListener('message', handler)
          reject(new Error(event.data.error))
        }
      }
      
      window.addEventListener('message', handler)
    })
  }
}
```

### 2. æƒé™æ§åˆ¶

```typescript
interface Permission {
  resource: string
  action: string
  conditions?: Record<string, any>
}

class PermissionManager {
  checkPermission(moduleId: string, permission: Permission): boolean {
    const modulePermissions = this.getModulePermissions(moduleId)
    return modulePermissions.some(p => 
      p.resource === permission.resource && 
      p.action === permission.action &&
      this.matchConditions(p.conditions, permission.conditions)
    )
  }

  private matchConditions(
    granted?: Record<string, any>, 
    required?: Record<string, any>
  ): boolean {
    if (!required) return true
    if (!granted) return false
    
    return Object.entries(required).every(([key, value]) => 
      granted[key] === value
    )
  }
}
```

---

*è¿™ä¸ªæŠ€æœ¯æ¶æ„ä¸º MingLog çš„æ¨¡å—åŒ–è®¾è®¡æä¾›äº†åšå®çš„åŸºç¡€ï¼Œç¡®ä¿ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ã€æ€§èƒ½å’Œå®‰å…¨æ€§ã€‚*
